import{aQ as t,G as e,bu as a,bp as s,aV as n,bt as r,c5 as o,c9 as i,cJ as c,b as l,dd as u,bF as d,bq as f,cm as m,de as p,bd as h,df as b,cG as v,dg as E,n as L,cg as g,bA as y,ah as w,ai as k,h as T,m as S,a9 as I,a4 as C,ad as q,dh as A,aC as $,d3 as N,bE as F,cn as O,M as P,c4 as R,cY as W,b4 as x,E as D,aU as J,g as M,b1 as V,aE as B,a0 as G,C as H,cw as U,aB as j}from"./common-60e5e246.js";const Q=document;let Y,_,z,K;const X={color:t(m),drawerRec:t(p+"-rec"),filter:t(h),filterField:t(h+"-field"),filterIcon:t(h+"-"+b),filterInput:t(h+"-"+n),filterState:t(h+"-state"),palette:t("palette"),profiles:t(v),profileTemplate:t(E+"-template"),record:t("record"),theme:t(L),themeIcon:t(L+"-"+b),title:t(g)};function Z(t,e){if(t.matches(e))return t;let a=t.parentElement;for(;a;){if(a.matches(e))return a;a=a.parentElement}return null}function tt(t){t&&t!==X.color.value&&(X.color.value=t),ui(L,t||X.color.value)}function et(t){Array.isArray(t)||(t=z),X.profiles.innerHTML="";const e=Q.createDocumentFragment();let a,s=[...t];if(s.unshift({n:I("q31"),k:C},{n:I("wcy"),k:""}),s=s.map(((t,e)=>{const a={...t};return a[l[13]].startsWith(q)||(a[l[8]]=e>1?e+3:e+1),a})),X.filterState.checked){const t=X.filterInput.value.trim();t&&(s=s.filter((e=>e[l[13]]&&function(t,e){const a=U(t);return t=t?.toLowerCase(),a?a.test(e):t?.startsWith('"')&&t?.endsWith('"')?(t=t.slice(1,-1).trim(),e.toLowerCase().trim()===t):e.toLowerCase().includes(t)}(t,e[l[13]]))))}s.forEach((t=>{if(t[l[13]].startsWith(q))return;const s=X.profileTemplate.content.cloneNode(!0);try{const n=s.querySelector(A);n.id=t[l[10]],t[l[8]]===Y&&(n.classList.add($),s.querySelector(l[0]).title+=` (${$})`,a=n),n.setAttribute(d+"-"+N,t[l[8]]),s.querySelector("h6").textContent=t[l[13]],e.appendChild(s)}catch(t){return}})),X.profiles.appendChild(e),a&&setTimeout((()=>{const t=a.getBoundingClientRect();(t.top<0||t.bottom>innerHeight)&&a.scrollIntoView({behavior:"smooth",block:"center"})}),100)}function at(t){const e=X.profiles.querySelector("."+$);e&&(e.classList.remove($),t.classList.add($),e.querySelector(l[0]).title=I("nh3TT"),t.querySelector(l[0]).title+=` (${$})`)}function st(t){let e;switch(t){case 0:e=R;break;case 1:e=O;break;case 2:e=ui(F);break;default:{const t=ui(F)===O;e=t?R:O,K[l[3]]=t?0:1,P({states:K})}}ui(F,e),X.themeIcon.classList.remove($),X.themeIcon.textContent=(e===O?R:O)+"_"+F,setTimeout((()=>{X.themeIcon.classList.add($)}),10)}function nt(t,e){let a=!0;switch(t[s+l[3]]&&(a=confirm(I("0hh"))),e.type){case u:a||(e.preventDefault(),t.querySelector(`[${d}-${f}]`)?.focus());break;case i:case r:e.preventDefault(),e.stopPropagation(),a&&t.close()}}function rt(t,e){if(e.key===W)t[s+l[3]]&&nt(t,e)}e([w,k,T,S],(t=>{Y=t.catnow,z=t.cats,K=t.states||{},st(K[l[3]]),tt(K[l[15]]),y(t.other.tooltips),X.filterInput.value=K.ft||"",K.fs&&X.filterState.click(),et(),Q.fonts.ready.then((()=>{setTimeout((()=>{Q.documentElement.removeAttribute(d+"-state")}),0)}))})),addEventListener(a,(function(){e([w,k],(t=>{if(_)return;let e=!1;t.catnow!==Y&&(e=!0,Y=t.catnow),JSON.stringify(t.cats)!==JSON.stringify(z)&&(e=!0,z=t.cats),e&&et()}))})),X.color?.addEventListener(s,(function(t){K[l[15]]=t.target.value,P({states:K})})),X.color?.addEventListener(n,(function(t){tt(t.target.value)})),X.filterField?.addEventListener("transitionend",(function(t){"transform"===t.propertyName&&(t.target.className.includes(x)||X.filterInput.focus())})),X.filterIcon?.addEventListener(r,(function(t){switch(t.key){case"Enter":case" ":X.filterState.click()}})),X.filterInput?.addEventListener(s,(function(t){const e=t.target.value.trim();e&&(K.ft=e,P({states:K}))})),X.filterInput?.addEventListener(n,o(et)),X.filterState?.addEventListener(s,(function(t){const e=t.target.checked;X.filterInput.tabIndex=e?0:-1,X.title.classList.toggle(x,e),X.filterField.classList.toggle(x,!e),et(),K.fs=+e,P({states:K})})),X.palette?.addEventListener(i,(function(){D&&X.color.dispatchEvent(new Event(n)),X.color.click()})),X.profiles.addEventListener("pointer"+c,(async function(t){if(0!==t.button)return;const e=t.target;switch(e.nodeName.toLowerCase()){case l[0]:{const t=Z(e,A),a=+t.getAttribute(d+"-"+N),s=Y===a;switch(e.title){case I("622TT"):confirm(I("nlt"))&&(z=z.filter((e=>e[l[10]]!==t.id)),s&&(Y=2),P({catnow:Y,cats:z},(()=>{et()})));break;case I("4d6TT"):s?H.openOptionsPage():(Y=a,P({catnow:Y},(()=>{H.openOptionsPage(),at(t)})));break;case I("nh3TT"):case`${I("nh3TT")} (${$})`:{const e=await B();e&&(_=!0,G({tabId:e,type:"eR",data:{catnow:a,force:!0}},(()=>{_=!1,H.lastError})),s||(Y=a,at(t)));break}}setTimeout((()=>Z(e,J)?.blur()),0);break}case J:{const t=e.lastElementChild,a=Z(t,A);if(t.nodeName===M.toUpperCase()){const s=d+"-"+M+"-"+j;setTimeout((()=>{getComputedStyle(t).getPropertyValue("visibility")===V?(e.blur(),a?.removeAttribute(s)):a?.setAttribute(s,"")}),0)}break}}})),X.record?.addEventListener(i,(function(){X.drawerRec.showModal()})),X.theme?.addEventListener(i,st),Q.querySelectorAll("dialog").forEach((t=>{t[s+l[3]]=!1,t.addEventListener(u,nt.bind(null,t)),t.addEventListener(r,rt.bind(null,t),!0),t.querySelector(`[${d}-${f}]`)?.addEventListener(i,nt.bind(null,t))}));
